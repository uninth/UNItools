<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../../../tocTab.js"></script>
<title>ActiveState::Unix::Crontab - Portable manipulation of the crontab system</title>
<link rel="stylesheet" href="../../../../../../Active.css" type="text/css" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>

<script>writelinks('__top__',6);</script>
<h1><a>ActiveState::Unix::Crontab - Portable manipulation of the crontab system</a></h1>
<p><a name="__index__"></a></p>

<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#example">EXAMPLE</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>ActiveState::Unix::Crontab - Portable manipulation of the crontab system</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 use ActiveState::Unix::Crontab qw(cron_add);</pre>
<pre>
 cron_add(cmd =&gt; &quot;ls -l /etc&quot;);</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>This module provides function that allow portable manipulation of the
crontab system found on Unix.</p>
<p>The following functions are provided and manipulate the crontab entry
for the current user</p>
<dl>
<dt><strong><a name="item_cron_edit"><code>cron_edit()</code></a></strong>

<dd>
<p>This function invokes the editor on the current crontab file.
The function will croak on failure.</p>
</dd>
</li>
<dt><strong><a name="item_cron_add">cron_add( $line )</a></strong>

<dt><strong>cron_add( %opts )</strong>

<dd>
<p>This function add an entry to the current crontab file.  The function
either takes a single cron line or a set of key/value paired
parameters; see <a href="#item_cron_parse"><code>cron_parse()</code></a> description below.  A <code>comment</code> can be
passed together with a <code>cmd</code>.</p>
</dd>
</li>
<dt><strong><a name="item_cron_format">$line = cron_format( %opts )</a></strong>

<dd>
<p>This formats a single crontab entry line.  This is the inverse of the
<a href="#item_cron_parse"><code>cron_parse()</code></a> function.  See the description of <a href="#item_cron_parse"><code>cron_parse()</code></a> for what
options to pass.</p>
</dd>
</li>
<dt><strong><a name="item_cron_parse">%opts = cron_parse( $line )</a></strong>

<dd>
<p>This taks a single crontab line and parse it out as a set of key/value
pairs.  This is the inverse of the <a href="#item_cron_format"><code>cron_format()</code></a> function.  The
<a href="#item_cron_list"><code>cron_list()</code></a> function is used to read out lines from crontab.</p>
</dd>
<dd>
<p>There are 4 different results that can be returned:</p>
</dd>
<ol>
<li>
<p>An empty line simply returns an empty %opts.</p>
</li>
<li>
<p>An line containing the setting of an environment variable returns:</p>
<pre>
  env:     name of the environment variable
  value:   the value it takes</pre>
</li>
<li>
<p>An line containing a scheduled command contains:</p>
<pre>
  cmd:     what command to execute
  data:    stdin data provided to the command
  enabled: is the command enabled or not
  min:     which minute to run
  hour:    which hour to run
  mday:    which day of month to run
  mon:     which month to run
  wday:    which week day to run</pre>
<p>Only <code>cmd</code> will always be there.  The <code>cmd</code> and <code>data</code> is plain
strings.  The <code>enabled</code> is a boolean.  The time and date fields take
a list of numbers or ranges:</p>
<pre>
  5
  1,2
  1-3
  1,2,5-9,12</pre>
<p>Note that no space is allowed in these values.  The range for <code>wday</code>
is 0 .. 6, with 0 as Sunday.</p>
<p>Portable applications should limit the settings to this format.  Some
implementations of cron also allow step values and/or plain English
names for the weekdays or months.</p>
</li>
<li>
<p>Anything else is returned as a comment:</p>
<pre>
  comment: comment text (including leading '#')</pre>
</li>
</ol>
<dt><strong><a name="item_cron_install">cron_install( @lines )</a></strong>

<dd>
<p>This installes the given crontab lines as the current crontab file.</p>
</dd>
</li>
<dt><strong><a name="item_cron_list">@lines = <code>cron_list()</code></a></strong>

<dd>
<p>This extract the crontab lines from the current crontab file.  The
lines are returned as is and can be parsed with the <a href="#item_cron_parse"><code>cron_parse()</code></a>
function.</p>
</dd>
</li>
<dt><strong><a name="item_cron_cmds">@cmds = <code>cron_cmds()</code></a></strong>

<dd>
<p>This extracts the currently installed crontab commands.</p>
</dd>
</li>
</dl>
<p>The following commands are available for 'root' to use:</p>
<dl>
<dt><strong><a name="item_cron_allow_user">cron_allow_user( $user )</a></strong>

<dd>
<p>This make sure that the given user is allowed to use the crontab
system.</p>
</dd>
</li>
<dt><strong><a name="item_cron_deny_user">cron_deny_user( $user )</a></strong>

<dd>
<p>The tell the system the the given user is to allowed to use the
crontab system.</p>
</dd>
</li>
<dt><strong><a name="item_cron_remove_user">cron_remove_user( $user )</a></strong>

<dd>
<p>This remove all records of the given user in the crontab system.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="example">EXAMPLE</a></h1>
<p>This disables all cron commands:</p>
<pre>
 #!/usr/bin/perl -w
 use ActiveState::Unix::Crontab qw(cron_list cron_install
                                   cron_parse cron_format);</pre>
<pre>
 my $mod;
 my @list = cron_list();</pre>
<pre>
 for (@list) {
     my %line = cron_parse($_);
     if ($line{cmd} &amp;&amp; $line{enabled}) {
         $line{enabled} = 0;
         $_ = cron_format(%line);
         $mod++;
     }
 }</pre>
<pre>
 cron_install(@list);</pre>
<p>Enabling them again is left as an exercise for the interested
developer.</p>
<p><a href="#item_cron_install"><code>cron_install(@list)</code></a> if $mod;</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>crontab</em></p>

</body>

</html>
