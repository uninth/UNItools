<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<title>./dialog.py</title>
<style type="text/css">
<!--
body.hl	{ background-color:#ffffff; }
pre.hl	{ color:#000000; background-color:#ffffff; font-size:10pt; font-family:Courier;}
.num	{ color:#ff0000; }
.esc	{ color:#ff22ff; }
.str	{ color:#ff0000; }
.dstr	{ color:#ff0000; }
.slc	{ color:#0000ff; }
.com	{ color:#0000ff; }
.dir	{ color:#ff22ff; }
.sym	{ color:#000000; }
.line	{ color:#0000ff; }
.kwa	{ color:#B26818; }
.kwb	{ color:#00ff00; }
.kwc	{ color:#B26818; }
.kwd	{ color:#000000; }
//-->
</style>
</head>
<body class="hl">
<pre class="hl"><span class="line">    0 </span><span class="dir"># $Id: dialog.py,v 1.3 2004/09/21 00:52:15 tom Exp $</span>
<span class="line">    1 </span><span class="dir"># Module: dialog.py</span>
<span class="line">    2 </span><span class="dir"># Copyright (c) 2000 Robb Shecter &lt;robb&#64;acm.org&gt;</span>
<span class="line">    3 </span><span class="dir"># All rights reserved.</span>
<span class="line">    4 </span><span class="dir"># This source is covered by the GNU GPL.</span>
<span class="line">    5 </span><span class="dir">#</span>
<span class="line">    6 </span><span class="dir"># This module is a Python wrapper around the Linux</span> <span class="dstr">&quot;dialog&quot;</span><span class="dir"> utility</span>
<span class="line">    7 </span><span class="dir"># by Savio Lam and Stuart Herbert.  My goals were to make dialog as</span>
<span class="line">    8 </span><span class="dir"># easy to use from Python as possible.  The demo code at the end of</span>
<span class="line">    9 </span><span class="dir"># the module is a good example of how to use it.  To run the demo,</span>
<span class="line">   10 </span><span class="dir"># execute:</span>
<span class="line">   11 </span><span class="dir">#</span>
<span class="line">   12 </span><span class="dir">#                       python dialog.py</span>
<span class="line">   13 </span><span class="dir">#</span>
<span class="line">   14 </span><span class="dir"># This module has one class in it,</span> <span class="dstr">&quot;Dialog&quot;</span><span class="dir">.  An application typically</span>
<span class="line">   15 </span><span class="dir"># creates an instance of it, and possibly sets the background title option.</span>
<span class="line">   16 </span><span class="dir"># Then, methods can be called on it for interacting with the user.</span>
<span class="line">   17 </span><span class="dir">#</span>
<span class="line">   18 </span><span class="dir"># I wrote this because I want to use my 486-33 laptop as my main</span>
<span class="line">   19 </span><span class="dir"># development computer (!), and I wanted a way to nicely interact with the</span>
<span class="line">   20 </span><span class="dir"># user in console mode.  There are apparently other modules out there</span>
<span class="line">   21 </span><span class="dir"># with similar functionality, but they require the Python curses library.</span>
<span class="line">   22 </span><span class="dir"># Writing this module from scratch was easier than figuring out how to</span>
<span class="line">   23 </span><span class="dir"># recompile Python with curses enabled. :)</span>
<span class="line">   24 </span><span class="dir">#</span>
<span class="line">   25 </span><span class="dir"># One interesting feature is that the menu and selection windows allow</span>
<span class="line">   26 </span><span class="dir"># *any* objects to be displayed and selected, not just strings.</span>
<span class="line">   27 </span><span class="dir">#</span>
<span class="line">   28 </span><span class="dir"># TO DO:</span>
<span class="line">   29 </span><span class="dir">#   Add code so that the input buffer is flushed before a dialog box is</span>
<span class="line">   30 </span><span class="dir">#     shown.  This would make the UI more predictable for users.  This</span>
<span class="line">   31 </span><span class="dir">#     feature could be turned on and off through an instance method.</span>
<span class="line">   32 </span><span class="dir">#   Drop using temporary files when interacting with</span> <span class="dstr">'dialog'</span><span class="dir"></span>
<span class="line">   33 </span><span class="dir">#     (it</span><span class="dstr">'s possible -- I'</span><span class="dir">ve already tried :-).</span>
<span class="line">   34 </span><span class="dir">#   Try detecting the terminal window size in order to make reasonable</span>
<span class="line">   35 </span><span class="dir">#     height and width defaults.  Hmmm - should also then check for</span>
<span class="line">   36 </span><span class="dir">#     terminal resizing...</span>
<span class="line">   37 </span><span class="dir">#   Put into a package name to make more reusable - reduce the possibility</span>
<span class="line">   38 </span><span class="dir">#     of name collisions.</span>
<span class="line">   39 </span><span class="dir">#</span>
<span class="line">   40 </span><span class="dir"># NOTES:</span>
<span class="line">   41 </span><span class="dir">#         there is a bug in (at least) Linux-Mandrake 7.0 Russian Edition</span>
<span class="line">   42 </span><span class="dir">#         running on AMD K6-2 3D that causes core dump when</span> <span class="dstr">'dialog'</span><span class="dir"></span>
<span class="line">   43 </span><span class="dir">#         is running with --gauge option;</span>
<span class="line">   44 </span><span class="dir">#         in this case you</span><span class="dstr">'ll have to recompile '</span><span class="dir">dialog</span><span class="dstr">' program.</span>
<span class="line">   45 </span><span class="dstr">#</span>
<span class="line">   46 </span><span class="dstr"># Modifications:</span>
<span class="line">   47 </span><span class="dstr"># Jul 2000, Sultanbek Tezadov (http://sultan.da.ru)</span>
<span class="line">   48 </span><span class="dstr">#    Added:</span>
<span class="line">   49 </span><span class="dstr">#       - '</span><span class="dir">gauge</span><span class="dstr">' widget *)</span>
<span class="line">   50 </span><span class="dstr">#       - '</span><span class="dir">title</span><span class="dstr">' option to some widgets</span>
<span class="line">   51 </span><span class="dstr">#       - '</span><span class="dir">checked</span><span class="dstr">' option to checklist dialog; clicking &quot;Cancel&quot; is now</span>
<span class="line">   52 </span><span class="dstr">#           recognizable</span>
<span class="line">   53 </span><span class="dstr">#       - '</span><span class="dir">selected</span><span class="dstr">' option to radiolist dialog; clicking &quot;Cancel&quot; is now</span>
<span class="line">   54 </span><span class="dstr">#           recognizable</span>
<span class="line">   55 </span><span class="dstr">#       - some other cosmetic changes and improvements</span>
<span class="line">   56 </span><span class="dstr">#</span>
<span class="line">   57 </span><span class="dstr"></span>
<span class="line">   58 </span><span class="dstr">import os</span>
<span class="line">   59 </span><span class="dstr">from tempfile import mktemp</span>
<span class="line">   60 </span><span class="dstr">from string import split</span>
<span class="line">   61 </span><span class="dstr">from time import sleep</span>
<span class="line">   62 </span><span class="dstr"></span>
<span class="line">   63 </span><span class="dstr">#</span>
<span class="line">   64 </span><span class="dstr"># Path of the dialog executable</span>
<span class="line">   65 </span><span class="dstr">#</span>
<span class="line">   66 </span><span class="dstr">DIALOG = os.getenv(&quot;DIALOG&quot;);</span>
<span class="line">   67 </span><span class="dstr">if DIALOG is None:</span>
<span class="line">   68 </span><span class="dstr">	DIALOG=&quot;../dialog&quot;;</span>
<span class="line">   69 </span><span class="dstr"></span>
<span class="line">   70 </span><span class="dstr">class Dialog:</span>
<span class="line">   71 </span><span class="dstr">    def __init__(self):</span>
<span class="line">   72 </span><span class="dstr">	self.__bgTitle = '</span><span class="dir"></span><span class="dstr">'               # Default is no background title</span>
<span class="line">   73 </span><span class="dstr"></span>
<span class="line">   74 </span><span class="dstr"></span>
<span class="line">   75 </span><span class="dstr">    def setBackgroundTitle(self, text):</span>
<span class="line">   76 </span><span class="dstr">	self.__bgTitle = '</span><span class="dir">--backtitle</span> <span class="dstr">&quot;%s&quot;</span><span class="dir"></span><span class="dstr">' % text</span>
<span class="line">   77 </span><span class="dstr"></span>
<span class="line">   78 </span><span class="dstr"></span>
<span class="line">   79 </span><span class="dstr">    def __perform(self, cmd):</span>
<span class="line">   80 </span><span class="dstr">	&quot;&quot;&quot;Do the actual work of invoking dialog and getting the output.&quot;&quot;&quot;</span>
<span class="line">   81 </span><span class="dstr">	fName = mktemp()</span>
<span class="line">   82 </span><span class="dstr">	rv = os.system('</span><span class="dir">%s %s %s 2&gt; %s</span><span class="dstr">' % (DIALOG, self.__bgTitle, cmd, fName))</span>
<span class="line">   83 </span><span class="dstr">	f = open(fName)</span>
<span class="line">   84 </span><span class="dstr">	output = f.readlines()</span>
<span class="line">   85 </span><span class="dstr">	f.close()</span>
<span class="line">   86 </span><span class="dstr">	os.unlink(fName)</span>
<span class="line">   87 </span><span class="dstr">	return (rv, output)</span>
<span class="line">   88 </span><span class="dstr"></span>
<span class="line">   89 </span><span class="dstr"></span>
<span class="line">   90 </span><span class="dstr">    def __perform_no_options(self, cmd):</span>
<span class="line">   91 </span><span class="dstr">	&quot;&quot;&quot;Call dialog w/out passing any more options. Needed by --clear.&quot;&quot;&quot;</span>
<span class="line">   92 </span><span class="dstr">	return os.system(DIALOG + '</span><span class="dir"></span> <span class="dstr">' + cmd)</span>
<span class="line">   93 </span><span class="dstr"></span>
<span class="line">   94 </span><span class="dstr"></span>
<span class="line">   95 </span><span class="dstr">    def __handleTitle(self, title):</span>
<span class="line">   96 </span><span class="dstr">	if len(title) == 0:</span>
<span class="line">   97 </span><span class="dstr">	    return '</span><span class="dir"></span><span class="dstr">'</span>
<span class="line">   98 </span><span class="dstr">	else:</span>
<span class="line">   99 </span><span class="dstr">	    return '</span><span class="dir">--title</span> <span class="dstr">&quot;%s&quot;</span><span class="dir"></span> <span class="dstr">' % title</span>
<span class="line">  100 </span><span class="dstr"></span>
<span class="line">  101 </span><span class="dstr"></span>
<span class="line">  102 </span><span class="dstr">    def yesno(self, text, height=10, width=30, title='</span><span class="dir"></span><span class="dstr">'):</span>
<span class="line">  103 </span><span class="dstr">	&quot;&quot;&quot;</span>
<span class="line">  104 </span><span class="dstr">	Put a Yes/No question to the user.</span>
<span class="line">  105 </span><span class="dstr">	Uses the dialog --yesno option.</span>
<span class="line">  106 </span><span class="dstr">	Returns a 1 or a 0.</span>
<span class="line">  107 </span><span class="dstr">	&quot;&quot;&quot;</span>
<span class="line">  108 </span><span class="dstr">	(code, output) = self.__perform(self.__handleTitle(title) +</span><span class="esc">\</span>
<span class="line">  109 </span><span class="dstr">	    '</span><span class="dir">--yesno</span> <span class="dstr">&quot;%s&quot;</span><span class="dir"> %d %d</span><span class="dstr">' % (text, height, width))</span>
<span class="line">  110 </span><span class="dstr">	return code == 0</span>
<span class="line">  111 </span><span class="dstr"></span>
<span class="line">  112 </span><span class="dstr"></span>
<span class="line">  113 </span><span class="dstr">    def msgbox(self, text, height=10, width=30, title='</span><span class="dir"></span><span class="dstr">'):</span>
<span class="line">  114 </span><span class="dstr">	&quot;&quot;&quot;</span>
<span class="line">  115 </span><span class="dstr">	Pop up a message to the user which has to be clicked</span>
<span class="line">  116 </span><span class="dstr">	away with &quot;ok&quot;.</span>
<span class="line">  117 </span><span class="dstr">	&quot;&quot;&quot;</span>
<span class="line">  118 </span><span class="dstr">	self.__perform(self.__handleTitle(title) +</span><span class="esc">\</span>
<span class="line">  119 </span><span class="dstr">	    '</span><span class="dir">--msgbox</span> <span class="dstr">&quot;%s&quot;</span><span class="dir"> %d %d</span><span class="dstr">' % (text, height, width))</span>
<span class="line">  120 </span><span class="dstr"></span>
<span class="line">  121 </span><span class="dstr"></span>
<span class="line">  122 </span><span class="dstr">    def infobox(self, text, height=10, width=30):</span>
<span class="line">  123 </span><span class="dstr">	&quot;&quot;&quot;Make a message to the user, and return immediately.&quot;&quot;&quot;</span>
<span class="line">  124 </span><span class="dstr">	self.__perform('</span><span class="dir">--infobox</span> <span class="dstr">&quot;%s&quot;</span><span class="dir"> %d %d</span><span class="dstr">' % (text, height, width))</span>
<span class="line">  125 </span><span class="dstr"></span>
<span class="line">  126 </span><span class="dstr"></span>
<span class="line">  127 </span><span class="dstr">    def inputbox(self, text, height=10, width=30, init='</span><span class="dir"></span><span class="dstr">', title='</span><span class="dir"></span><span class="dstr">'):</span>
<span class="line">  128 </span><span class="dstr">	&quot;&quot;&quot;</span>
<span class="line">  129 </span><span class="dstr">	Request a line of input from the user.</span>
<span class="line">  130 </span><span class="dstr">	Returns the user'</span><span class="dir">s input or None if cancel was chosen.</span>
<span class="line">  131 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  132 </span><span class="str">	(c, o) = self.__perform(self.__handleTitle(title) +</span><span class="esc">\</span>
<span class="line">  133 </span><span class="str">	    '--inputbox &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d &quot;</span><span class="sym">%</span>s<span class="str">&quot;' % (text, height, width, init))</span>
<span class="line">  134 </span><span class="str">	try:</span>
<span class="line">  135 </span><span class="str">	    return o[0]</span>
<span class="line">  136 </span><span class="str">	except IndexError:</span>
<span class="line">  137 </span><span class="str">	    if c == 0:  # empty string entered</span>
<span class="line">  138 </span><span class="str">		return ''</span>
<span class="line">  139 </span><span class="str">	    else:  # canceled</span>
<span class="line">  140 </span><span class="str">		return None</span>
<span class="line">  141 </span><span class="str"></span>
<span class="line">  142 </span><span class="str"></span>
<span class="line">  143 </span><span class="str">    def textbox(self, filename, height=20, width=60, title=None):</span>
<span class="line">  144 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>Display a file in a scrolling text box<span class="sym">.</span><span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  145 </span><span class="str">	if title is None:</span>
<span class="line">  146 </span><span class="str">	    title = filename</span>
<span class="line">  147 </span><span class="str">	self.__perform(self.__handleTitle(title) +</span><span class="esc">\</span>
<span class="line">  148 </span><span class="str">	    ' --textbox &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d' % (filename, height, width))</span>
<span class="line">  149 </span><span class="str"></span>
<span class="line">  150 </span><span class="str"></span>
<span class="line">  151 </span><span class="str">    def menu(self, text, height=15, width=54, list=[]):</span>
<span class="line">  152 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  153 </span>	Display a menu of options to the user<span class="sym">.</span>  This method simplifies the
<span class="line">  154 </span>	<span class="sym">--</span>menu option of dialog<span class="sym">,</span> which allows <span class="kwa">for</span> <span class="kwb">complex</span> arguments<span class="sym">.</span>  This
<span class="line">  155 </span>	method receives a simple list of objects<span class="sym">,</span> <span class="kwa">and</span> each one is assigned
<span class="line">  156 </span>	a choice number<span class="sym">.</span>
<span class="line">  157 </span>	The selected object is returned<span class="sym">,</span> <span class="kwa">or</span> None <span class="kwa">if</span> the dialog was canceled<span class="sym">.</span>
<span class="line">  158 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  159 </span><span class="str">	menuheight = height - 8</span>
<span class="line">  160 </span><span class="str">	pairs = map(lambda i, item: (i + 1, item), range(len(list)), list)</span>
<span class="line">  161 </span><span class="str">	choices = reduce(lambda res, pair: res + '%d &quot;</span><span class="sym">%</span>s<span class="str">&quot; ' % pair, pairs, '')</span>
<span class="line">  162 </span><span class="str">	(code, output) = self.__perform('--menu &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d %d %s' %</span><span class="esc">\</span>
<span class="line">  163 </span><span class="str">	    (text, height, width, menuheight, choices))</span>
<span class="line">  164 </span><span class="str">	try:</span>
<span class="line">  165 </span><span class="str">	    return list[int(output[0]) - 1]</span>
<span class="line">  166 </span><span class="str">	except IndexError:</span>
<span class="line">  167 </span><span class="str">	    return None</span>
<span class="line">  168 </span><span class="str"></span>
<span class="line">  169 </span><span class="str"></span>
<span class="line">  170 </span><span class="str">    def checklist(self, text, height=15, width=54, list=[], checked=None):</span>
<span class="line">  171 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  172 </span>	Returns a list of the selected objects<span class="sym">.</span>
<span class="line">  173 </span>	Returns an empty list <span class="kwa">if</span> nothing was selected<span class="sym">.</span>
<span class="line">  174 </span>	Returns None <span class="kwa">if</span> the window was canceled<span class="sym">.</span>
<span class="line">  175 </span>	checked <span class="sym">--</span> a list of <span class="kwd">boolean</span> <span class="sym">(</span><span class="num">0</span><span class="sym">/</span><span class="num">1</span><span class="sym">)</span> values<span class="sym">;</span> <span class="kwd">len</span><span class="sym">(</span>checked<span class="sym">)</span> must equal
<span class="line">  176 </span>	    <span class="kwd">len</span><span class="sym">(</span>list<span class="sym">).</span>
<span class="line">  177 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  178 </span><span class="str">	if checked is None:</span>
<span class="line">  179 </span><span class="str">	    checked = [0]*len(list)</span>
<span class="line">  180 </span><span class="str">	menuheight = height - 8</span>
<span class="line">  181 </span><span class="str">	triples = map(</span>
<span class="line">  182 </span><span class="str">	    lambda i, item, onoff, fs=('off', 'on'): (i + 1, item, fs[onoff]),</span>
<span class="line">  183 </span><span class="str">	    range(len(list)), list, checked)</span>
<span class="line">  184 </span><span class="str">	choices = reduce(lambda res, triple: res + '%d &quot;</span><span class="sym">%</span>s<span class="str">&quot; %s ' % triple,</span>
<span class="line">  185 </span><span class="str">	    triples, '')</span>
<span class="line">  186 </span><span class="str">	(c, o) = self.__perform('--checklist &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d %d %s' %</span><span class="esc">\</span>
<span class="line">  187 </span><span class="str">	    (text, height, width, menuheight, choices))</span>
<span class="line">  188 </span><span class="str">	try:</span>
<span class="line">  189 </span><span class="str">	    output = o[0]</span>
<span class="line">  190 </span><span class="str">	    indexList  = map(lambda x: int(x[1:-1]), split(output))</span>
<span class="line">  191 </span><span class="str">	    objectList = filter(lambda item, list=list, indexList=indexList:</span>
<span class="line">  192 </span><span class="str">		    list.index(item) + 1 in indexList,</span>
<span class="line">  193 </span><span class="str">		list)</span>
<span class="line">  194 </span><span class="str">	    return objectList</span>
<span class="line">  195 </span><span class="str">	except IndexError:</span>
<span class="line">  196 </span><span class="str">	    if c == 0:                        # Nothing was selected</span>
<span class="line">  197 </span><span class="str">		return []</span>
<span class="line">  198 </span><span class="str">	    return None  # Was canceled</span>
<span class="line">  199 </span><span class="str"></span>
<span class="line">  200 </span><span class="str"></span>
<span class="line">  201 </span><span class="str">    def radiolist(self, text, height=15, width=54, list=[], selected=0):</span>
<span class="line">  202 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  203 </span>	Return the selected object<span class="sym">.</span>
<span class="line">  204 </span>	Returns empty string <span class="kwa">if</span> no choice was selected<span class="sym">.</span>
<span class="line">  205 </span>	Returns None <span class="kwa">if</span> window was canceled<span class="sym">.</span>
<span class="line">  206 </span>	selected <span class="sym">--</span> the selected <span class="kwd">item</span> <span class="sym">(</span>must be between <span class="num">1</span> <span class="kwa">and</span> <span class="kwd">len</span><span class="sym">(</span>list<span class="sym">)</span>
<span class="line">  207 </span>	    <span class="kwa">or</span> <span class="num">0</span><span class="sym">,</span> meaning no selection<span class="sym">).</span>
<span class="line">  208 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  209 </span><span class="str">	menuheight = height - 8</span>
<span class="line">  210 </span><span class="str">	triples = map(lambda i, item: (i + 1, item, 'off'),</span>
<span class="line">  211 </span><span class="str">	    range(len(list)), list)</span>
<span class="line">  212 </span><span class="str">	if selected:</span>
<span class="line">  213 </span><span class="str">	    i, item, tmp = triples[selected - 1]</span>
<span class="line">  214 </span><span class="str">	    triples[selected - 1] = (i, item, 'on')</span>
<span class="line">  215 </span><span class="str">	choices = reduce(lambda res, triple: res + '%d &quot;</span><span class="sym">%</span>s<span class="str">&quot; %s ' % triple,</span>
<span class="line">  216 </span><span class="str">	    triples, '')</span>
<span class="line">  217 </span><span class="str">	(c, o) = self.__perform('--radiolist &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d %d %s' %</span><span class="esc">\</span>
<span class="line">  218 </span><span class="str">	    (text, height, width, menuheight, choices))</span>
<span class="line">  219 </span><span class="str">	try:</span>
<span class="line">  220 </span><span class="str">	    return list[int(o[0]) - 1]</span>
<span class="line">  221 </span><span class="str">	except IndexError:</span>
<span class="line">  222 </span><span class="str">	    if c == 0:</span>
<span class="line">  223 </span><span class="str">		return ''</span>
<span class="line">  224 </span><span class="str">	    return None</span>
<span class="line">  225 </span><span class="str"></span>
<span class="line">  226 </span><span class="str"></span>
<span class="line">  227 </span><span class="str">    def clear(self):</span>
<span class="line">  228 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  229 </span>	Clear the screen<span class="sym">.</span> Equivalent to the dialog <span class="sym">--</span>clear option<span class="sym">.</span>
<span class="line">  230 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  231 </span><span class="str">	self.__perform_no_options('--clear')</span>
<span class="line">  232 </span><span class="str"></span>
<span class="line">  233 </span><span class="str"></span>
<span class="line">  234 </span><span class="str">    def scrollbox(self, text, height=20, width=60, title=''):</span>
<span class="line">  235 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  236 </span>	This is a bonus method<span class="sym">.</span>  The dialog package only has a function to
<span class="line">  237 </span>	display a file in a scrolling text field<span class="sym">.</span>  This method allows any
<span class="line">  238 </span>	string to be displayed by first saving it in a temp file<span class="sym">,</span> <span class="kwa">and</span> calling
<span class="line">  239 </span>	<span class="sym">--</span>textbox<span class="sym">.</span>
<span class="line">  240 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  241 </span><span class="str">	fName = mktemp()</span>
<span class="line">  242 </span><span class="str">	f = open(fName, 'w')</span>
<span class="line">  243 </span><span class="str">	f.write(text)</span>
<span class="line">  244 </span><span class="str">	f.close()</span>
<span class="line">  245 </span><span class="str">	self.__perform(self.__handleTitle(title) +</span><span class="esc">\</span>
<span class="line">  246 </span><span class="str">	    '--textbox &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d' % (fName, height, width))</span>
<span class="line">  247 </span><span class="str">	os.unlink(fName)</span>
<span class="line">  248 </span><span class="str"></span>
<span class="line">  249 </span><span class="str"></span>
<span class="line">  250 </span><span class="str">    def gauge_start(self, perc=0, text='', height=8, width=54, title=''):</span>
<span class="line">  251 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  252 </span>	Display gauge output window<span class="sym">.</span>
<span class="line">  253 </span>	Gauge normal <span class="kwd">usage</span> <span class="sym">(</span>assuming that there is an instace of <span class="str">'Dialog'</span>
<span class="line">  254 </span>	<span class="kwc">class</span> named <span class="str">'d'</span><span class="sym">):</span>
<span class="line">  255 </span>	    d<span class="sym">.</span><span class="kwd">gauge_start</span><span class="sym">()</span>
<span class="line">  256 </span>	    <span class="dir"># do something</span>
<span class="line">  257 </span>	    d<span class="sym">.</span><span class="kwd">gauge_iterate</span><span class="sym">(</span><span class="num">10</span><span class="sym">)</span>  <span class="dir"># passed throgh 10%</span>
<span class="line">  258 </span>	    <span class="dir"># ...</span>
<span class="line">  259 </span>	    d<span class="sym">.</span><span class="kwd">gauge_iterate</span><span class="sym">(</span><span class="num">100</span><span class="sym">,</span> <span class="str">'any text here'</span><span class="sym">)</span>  <span class="dir"># work is done</span>
<span class="line">  260 </span>	    d<span class="sym">.</span><span class="kwd">stop_gauge</span><span class="sym">()</span>  <span class="dir"># clean-up actions</span>
<span class="line">  261 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  262 </span><span class="str">	cmd = self.__handleTitle(title) +</span><span class="esc">\</span>
<span class="line">  263 </span><span class="str">	    '--gauge &quot;</span><span class="sym">%</span>s<span class="str">&quot; %d %d %d' % (text, height, width, perc)</span>
<span class="line">  264 </span><span class="str">	cmd = '%s %s %s 2&gt; /dev/null' % (DIALOG, self.__bgTitle, cmd)</span>
<span class="line">  265 </span><span class="str">	self.pipe = os.popen(cmd, 'w')</span>
<span class="line">  266 </span><span class="str">    #/gauge_start()</span>
<span class="line">  267 </span><span class="str"></span>
<span class="line">  268 </span><span class="str"></span>
<span class="line">  269 </span><span class="str">    def gauge_iterate(self, perc, text=''):</span>
<span class="line">  270 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  271 </span>	Update percentage point value<span class="sym">.</span>
<span class="line">  272 </span>
<span class="line">  273 </span>	See <span class="kwd">gauge_start</span><span class="sym">()</span> function above <span class="kwa">for</span> the usage<span class="sym">.</span>
<span class="line">  274 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  275 </span><span class="str">	if text:</span>
<span class="line">  276 </span><span class="str">	    text = 'XXX</span><span class="esc">\n</span><span class="str">%d</span><span class="esc">\n</span><span class="str">%s</span><span class="esc">\n</span><span class="str">XXX</span><span class="esc">\n</span><span class="str">' % (perc, text)</span>
<span class="line">  277 </span><span class="str">	else:</span>
<span class="line">  278 </span><span class="str">	    text = '%d</span><span class="esc">\n</span><span class="str">' % perc</span>
<span class="line">  279 </span><span class="str">	self.pipe.write(text)</span>
<span class="line">  280 </span><span class="str">	self.pipe.flush()</span>
<span class="line">  281 </span><span class="str">    #/gauge_iterate()</span>
<span class="line">  282 </span><span class="str"></span>
<span class="line">  283 </span><span class="str"></span>
<span class="line">  284 </span><span class="str">    def gauge_stop(self):</span>
<span class="line">  285 </span><span class="str">	&quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  286 </span>	Finish previously started gauge<span class="sym">.</span>
<span class="line">  287 </span>
<span class="line">  288 </span>	See <span class="kwd">gauge_start</span><span class="sym">()</span> function above <span class="kwa">for</span> the usage<span class="sym">.</span>
<span class="line">  289 </span>	<span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  290 </span><span class="str">	self.pipe.close()</span>
<span class="line">  291 </span><span class="str">    #/gauge_stop()</span>
<span class="line">  292 </span><span class="str"></span>
<span class="line">  293 </span><span class="str"></span>
<span class="line">  294 </span><span class="str"></span>
<span class="line">  295 </span><span class="str">#</span>
<span class="line">  296 </span><span class="str"># DEMO APPLICATION</span>
<span class="line">  297 </span><span class="str">#</span>
<span class="line">  298 </span><span class="str">if __name__ == '__main__':</span>
<span class="line">  299 </span><span class="str">    &quot;</span><span class="str">&quot;&quot;</span>
<span class="line">  300 </span>    This demo tests all the features of the <span class="kwc">class</span><span class="sym">.</span>
<span class="line">  301 </span>    <span class="str">&quot;&quot;</span><span class="str">&quot;</span>
<span class="line">  302 </span><span class="str">    d = Dialog()</span>
<span class="line">  303 </span><span class="str">    d.setBackgroundTitle('dialog.py demo')</span>
<span class="line">  304 </span><span class="str"></span>
<span class="line">  305 </span><span class="str">    d.infobox(</span>
<span class="line">  306 </span><span class="str">	&quot;</span>One moment<span class="sym">...</span> Just wasting some time here to test the infobox<span class="sym">...</span><span class="str">&quot;)</span>
<span class="line">  307 </span><span class="str">    sleep(3)</span>
<span class="line">  308 </span><span class="str"></span>
<span class="line">  309 </span><span class="str">    if d.yesno(&quot;</span>Do you like <span class="kwa">this</span> demo?<span class="str">&quot;):</span>
<span class="line">  310 </span><span class="str">	d.msgbox(&quot;</span>Excellent<span class="sym">!</span>  Here<span class="str">'s the source code:&quot;)</span>
<span class="line">  311 </span><span class="str">    else:</span>
<span class="line">  312 </span><span class="str">	d.msgbox(&quot;Send your complaints to /dev/null&quot;)</span>
<span class="line">  313 </span><span class="str"></span>
<span class="line">  314 </span><span class="str">    d.textbox(&quot;dialog.py&quot;)</span>
<span class="line">  315 </span><span class="str"></span>
<span class="line">  316 </span><span class="str">    name = d.inputbox(&quot;What'</span>s your name?<span class="str">&quot;, init=&quot;</span>Snow White<span class="str">&quot;)</span>
<span class="line">  317 </span><span class="str">    fday = d.menu(&quot;</span>What<span class="str">'s your favorite day of the week?&quot;,</span>
<span class="line">  318 </span><span class="str">	list=[&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;,</span>
<span class="line">  319 </span><span class="str">	    &quot;Friday (The best day of all)&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;])</span>
<span class="line">  320 </span><span class="str">    food = d.checklist(&quot;What sandwich toppings do you like?&quot;,</span>
<span class="line">  321 </span><span class="str">	list=[&quot;Catsup&quot;, &quot;Mustard&quot;, &quot;Pesto&quot;, &quot;Mayonaise&quot;, &quot;Horse radish&quot;,</span>
<span class="line">  322 </span><span class="str">	    &quot;Sun-dried tomatoes&quot;], checked=[0,0,0,1,1,1])</span>
<span class="line">  323 </span><span class="str">    sand = d.radiolist(&quot;What'</span>s your favorite kind of sandwich?<span class="str">&quot;,</span>
<span class="line">  324 </span><span class="str">	list=[&quot;</span>Hamburger<span class="str">&quot;, &quot;</span>Hotdog<span class="str">&quot;, &quot;</span>Burrito<span class="str">&quot;, &quot;</span>Doener<span class="str">&quot;, &quot;</span>Falafel<span class="str">&quot;,</span>
<span class="line">  325 </span><span class="str">	    &quot;</span>Bagel<span class="str">&quot;, &quot;</span>Big Mac<span class="str">&quot;, &quot;</span>Whopper<span class="str">&quot;, &quot;</span>Quarter Pounder<span class="str">&quot;,</span>
<span class="line">  326 </span><span class="str">	    &quot;</span>Peanut Butter <span class="kwa">and</span> Jelly<span class="str">&quot;, &quot;</span>Grilled cheese<span class="str">&quot;], selected=4)</span>
<span class="line">  327 </span><span class="str"></span>
<span class="line">  328 </span><span class="str">    # Prepare the message for the final window</span>
<span class="line">  329 </span><span class="str">    bigMessage = &quot;</span>Here are some vital statistics about you<span class="sym">:</span>\n\nName<span class="sym">:</span> <span class="str">&quot; + name +</span><span class="esc">\</span>
<span class="line">  330 </span><span class="str">        &quot;</span>\nFavorite day of the week<span class="sym">:</span> <span class="str">&quot; + fday +</span><span class="esc">\</span>
<span class="line">  331 </span><span class="str">	&quot;</span>\nFavorite sandwich toppings<span class="sym">:</span>\n<span class="str">&quot;</span>
<span class="line">  332 </span><span class="str">    for topping in food:</span>
<span class="line">  333 </span><span class="str">	bigMessage = bigMessage + &quot;</span>    <span class="str">&quot; + topping + &quot;</span>\n<span class="str">&quot;</span>
<span class="line">  334 </span><span class="str">    bigMessage = bigMessage + &quot;</span>Favorite sandwich<span class="sym">:</span> <span class="str">&quot; + str(sand)</span>
<span class="line">  335 </span><span class="str"></span>
<span class="line">  336 </span><span class="str">    d.scrollbox(bigMessage)</span>
<span class="line">  337 </span><span class="str"></span>
<span class="line">  338 </span><span class="str">    #&lt;&gt;#  Gauge Demo</span>
<span class="line">  339 </span><span class="str">    d.gauge_start(0, 'percentage: 0', title='Gauge Demo')</span>
<span class="line">  340 </span><span class="str">    for i in range(1, 101):</span>
<span class="line">  341 </span><span class="str">	if i &lt; 50:</span>
<span class="line">  342 </span><span class="str">	    msg = 'percentage: %d' % i</span>
<span class="line">  343 </span><span class="str">	elif i == 50:</span>
<span class="line">  344 </span><span class="str">	    msg = 'Over 50%'</span>
<span class="line">  345 </span><span class="str">	else:</span>
<span class="line">  346 </span><span class="str">	    msg = ''</span>
<span class="line">  347 </span><span class="str">	d.gauge_iterate(i, msg)</span>
<span class="line">  348 </span><span class="str">	sleep(0.1)</span>
<span class="line">  349 </span><span class="str">    d.gauge_stop()</span>
<span class="line">  350 </span><span class="str">    #&lt;&gt;#</span>
<span class="line">  351 </span><span class="str"></span>
<span class="line">  352 </span><span class="str">    d.clear()</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 2.4.3, http://www.andre-simon.de/-->
